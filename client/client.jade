head
    title jam night
    meta(name='viewport', content='user-scalable=yes, initial-scale=1.0, maximum-scale=1.5, width=device-width')
    meta(name='apple-mobile-web-app-capable', content='yes')
    meta(name='apple-mobile-web-app-status-bar-style', content='black')
    
    link(rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon.png")
    link(rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png")
    link(rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png")
    link(rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png")
    link(rel="manifest" href="/site.webmanifest")

    link(rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5")
    meta(name="apple-mobile-web-app-title" content="jamnight")
    meta(name="application-name" content="jamnight")
    meta(name="msapplication-TileColor" content="#da532c")
    meta(name="theme-color" content="#ffffff")
    

    link(rel='stylesheet' type='text/css' href='https://cdn.jsdelivr.net/npm/fomantic-ui@2.9.2/dist/semantic.min.css')
    // link(href="https://fonts.googleapis.com/css?family=Varela+Round&display=swap" rel="stylesheet")
    link(href="https://fonts.googleapis.com/css?family=Ubuntu:300,400&display=swap" rel="stylesheet")
    script(src='https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js')
    script(src='https://cdn.jsdelivr.net/npm/fomantic-ui@2.9.2/dist/semantic.min.js')
    
    // script(src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js")
    link(href="https://cdn.jsdelivr.net/npm/suneditor@latest/dist/css/suneditor.min.css" rel="stylesheet")
    script(src="https://cdn.jsdelivr.net/npm/suneditor@latest/dist/suneditor.min.js")
    script(src="https://cdn.jsdelivr.net/npm/suneditor@latest/src/lang/en.js")

    //- script(async='', src='https://www.googletagmanager.com/gtag/js?id=UA-140259454-1')
    script.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'G-GLYPPRGJFQ');
template(name='nav')
    // https://fomantic-ui.com/elements/icon.html#/icon
    #topnav.topnav.ui.attached.borderless.menu.hscroll
        if is_loading
            .icon.item
                i.big.loading.grey.refresh.icon.cancel
        // else 
        a.header.item.zoomer(href='/' class="{{isActivePath '/'}}" )
            +icolor name='music-band'
            |&nbsp;
            |&nbsp;
            // img(src='/android-chrome-192x192.png')
            strong.mobile.hidden jam night
        a.header.item.zoomer(href='/tasks' class="{{isActivePath '/tasks'}}" )
            +icolor name='tasks'
            // img(src='/android-chrome-192x192.png')
            strong.mobile.hidden tasks
        a.header.item.zoomer(href='/users' class="{{isActivePath '/users'}}" )
            +icolor name='groups'
            // img(src='/android-chrome-192x192.png')
            strong.mobile.hidden people
        a.header.item.zoomer(href='/events' class="{{isActivePath '/events'}}" )
            +icolor name='calendar'
            // img(src='/android-chrome-192x192.png')
            strong.mobile.hidden events
        a.icon.item.invert_toggle(title='dark mode')
            +i name='light'
        // // .icon.item 
        // //     i.large.search.icon
        // .search.item.zoomer.mobile.hidden(title='search')
        //     .ui.icon.input
        //         if current_product_search
        //             i.remove.large.red.link.icon.clear_search
        //         else
        //             i.search.large.icon
        //         input.global_search(type='text' autocomplete="off" value=current_searchs)
        .right.menu
            if currentUser
                // a.icon.item.add_post(title='add post')
                //     // i.large.plus.icon
                //     +i name='plus'
                // a.icon.item(href="/coin" class="{{isActiveRoute 'coin'}}" title='bank')
                //     // i.large.inbox.icon
                //     strong #{currentUser.coins}
                //     +i name='coins'
                a.item(href="/user/#{currentUser.username}" class="{{isActiveRoute 'user'}}" title='user')
                    if currentUser.image_id
                        img.ui.avatar.image(src="{{c.url currentUser.image_id width=200 height=200 gravity='face' crop='fill'}}")
                    else
                        i.user.icon
                    strong #{currentUser.name}
                    +i name='star' cl='ui avatar image'
                    | #{currentUser.points}p
                    +i name='coins'
                    | #{currentUser.credit}c
            unless subs_ready
                .icon.item
                    i.yin.yang.large.loading.icon
            unless currentUser
                a.item(href="/register" title='register')
                    +i name='plus'
                    span.mobile.hidden register            
                a.item(href='/login' title='login') 
                    // i.sign.in.large.icon
                    +i name='internal'
                    span.mobile.hidden login
                
    
template(name='layout')
    // img.ui.fluid.image.checkin_banner(src="{{c.url 'cafe'}}")
    +nav
    +yield
    if in_dev
        +footer


template(name='home')
    .ui.centered.padded.stackable.grid 
        .center.aligned.row
            .ten.wide.center.aligned.column 
                .ui.header welcome to jam night
                .ui.fluid.button sign in
                .ui.large.fluid.input
                    input(type='text' placeholder='name')
                each users 
                    .ui.button.pick_user 
                        |#{username}
                .ui.big.circular.button
                    +i name='audience'
                    |audience
                .ui.big.circular.button
                    +i name='music'
                    |musician
                .ui.big.circular.button
                    +i name='volunteering'
                    |volunteer
                div
                .ui.big.circular.button
                    +i name='guitar-strings'
                    |bass
                .ui.big.circular.button
                    +i name='guitar'
                    |guitar
                .ui.big.circular.button
                    +i name='drum-set'
                    |drums
                .ui.big.circular.button
                    +i name='piano'
                    |piano
                .ui.big.circular.button
                    +i name='concert'
                    |singer
                .ui.big.fluid.green.button 
                    |sign in
            each user_docs
                .ui.button #{username}
                
                
                
template(name='not_found')
    .ui.center.aligned.padded.basic.segment
        +ibig name='park-bench' 
            |browser_back
        .ui.center.aligned.header page not found
        a.ui.big.basic.button.fly_right(href="/") 
            +i name='home' 
            |home
        .ui.basic.big.button.browser_back.fly_right
            // i.undo.icon
            +i name='undo'
            |back


template(name='footer')
    .ui.padded.inverted.grid.segment
        .one.column.row
            .column
                if currentUser.admin_mode
                    +print_this
                with currentUser
                    +print_this
                    if in_dev
                        +boolean_edit key='admin_mode' label='admin mode'  
                if currentUser.admin_mode
                    .ui.inverted.inline.header 
                        i.user.icon
                        |#{user_docs.count} users 
                    each user_docs 
                        a.ui.image.inverted.black.basic.label(href="/user/#{username}")
                            img.ui.avatar.image.zoomer(src="{{c.url image_id width=300 height=300 crop='crop'}}")    
                            |#{username}
                        if current_user.admin_mode
                            +print_this
                    div
                    .ui.inverted.inline.header 
                        i.blog.icon
                        |#{doc_docs.count} docs 
                    each doc_docs
                        a.ui.image.inverted.black.basic.label(href="/#{model}/#{_id}")
                            img.ui.avatar.image.zoomer(src="{{c.url image_id width=300 height=300 crop='crop'}}")    
                            if title
                                |{{{cut title}}}...
                            else if body
                                |{{{cut body}}}...
                            small [#{model}]
                    div
                    .ui.inverted.inline.header 
                        i.tag.icon
                        |#{result_docs.count} results 
                    each result_docs
                        .ui.inverted.basic.label #{name}: #{model}